# Ядро приложения (Core)

## Обзор

Ядро приложения содержит основные компоненты, которые обеспечивают работу всего приложения PDFmanager. Оно включает в себя управление состоянием, событийную систему, логирование и конфигурацию.

## Компоненты ядра

### AppCore
- **Назначение**: Центральный компонент, управляющий жизненным циклом приложения
- **Функции**:
  - Инициализация приложения
  - Управление зависимостями
  - Оркестрация других компонентов
  - Обработка глобальных событий

### StateManager
- **Назначение**: Управление состоянием приложения
- **Функции**:
  - Хранение и обновление состояния
  - Уведомления об изменениях
  - Валидация данных
  - Поддержка реактивных обновлений

### EventBus
- **Назначение**: Централизованная система событий
- **Функции**:
  - Публикация и подписка на события
  - Обработка асинхронных событий
  - Обеспечение слабой связанности компонентов
  - Поддержка middleware для событий

### Logger
- **Назначение**: Система логирования приложения
- **Функции**:
  - Запись логов различных уровней
  - Форматирование сообщений
  - Вывод в консоль и файлы
  - Поддержка различных форматов

### Config
- **Назначение**: Управление конфигурацией приложения
- **Функции**:
  - Загрузка и сохранение настроек
  - Валидация конфигурации
  - Поддержка различных источников конфигурации
  - Обработка изменений конфигурации

## Архитектурные решения

### Единый источник правды
Все состояние приложения централизовано в StateManager, что обеспечивает согласованность данных и упрощает отладку.

### Слабая связанность
Компоненты взаимодействуют через EventBus, что позволяет избежать жестких зависимостей и упрощает тестирование.

### Модульность
Каждый компонент ядра имеет четко определенную ответственность и может быть заменен или модифицирован независимо.

## Использование

### Инициализация ядра
```typescript
import { AppCore } from '@core/app-core';
import { StateManager } from '@core/state-manager';
import { EventBus } from '@core/event-bus';
import { Logger } from '@core/logger';
import { Config } from '@core/config';

const eventBus = new EventBus();
const logger = new Logger();
const config = new Config();
const stateManager = new StateManager({ eventBus, logger });

const appCore = new AppCore({
  stateManager,
  eventBus,
  logger,
  config
});

await appCore.initialize();
```

### Подписка на события
```typescript
eventBus.on('app:ready', () => {
  console.log('Application is ready');
});

eventBus.on('state:changed', (data) => {
  console.log('State changed:', data);
});
```

### Обновление состояния
```typescript
stateManager.update('userSettings', {
  theme: 'dark',
  language: 'ru'
});
```

## Тестирование

Каждый компонент ядра тестируется отдельно:
- Модульные тесты для каждого класса
- Интеграционные тесты для взаимодействия компонентов
- Тесты производительности для критических операций

## Безопасность

- Все данные валидируются перед сохранением в состоянии
- Логирование чувствительных данных ограничено
- Конфигурация защищена от несанкционированного доступа